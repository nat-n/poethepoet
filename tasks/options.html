<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<meta property="og:title" content="Standard task options" />
<meta property="og:type" content="website" />
<meta property="og:url" content="tasks/options.html" />
<meta property="og:site_name" content="Poe the Poet" />
<meta property="og:description" content="Overview: The following options can be configured on your tasks and are not specific to any particular task type. help, str ðŸ“–, Help text to be displayed next to the task name in the documentation w..." />
<meta name="description" content="Overview: The following options can be configured on your tasks and are not specific to any particular task type. help, str ðŸ“–, Help text to be displayed next to the task name in the documentation w..." />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="cmd tasks" href="task_types/cmd.html" /><link rel="prev" title="Defining tasks" href="index.html" />
        <link rel="canonical" href="http://poethepoet.natn.io/tasks/options.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 7.4.7 and Furo 2023.09.10 -->
        <title>Standard task options - Poe the Poet</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=36a5483c" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">Poe the Poet</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo only-light" src="../_static/poe_logo_x2000.png" alt="Light Logo"/>
    <img class="sidebar-logo only-dark" src="../_static/poe_logo_x2000.png" alt="Dark Logo"/>
  </div>
  
  <span class="sidebar-brand-text">Poe the Poet</span>
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../poetry_plugin.html">Poetry plugin</a></li>
<li class="toctree-l1"><a class="reference internal" href="../global_options.html">Global options</a></li>
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Defining tasks</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Defining tasks</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Standard task options</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/cmd.html">Command tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/script.html">Script tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/shell.html">Shell tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/sequence.html">Sequence tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/parallel.html">Parallel tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/expr.html">Expression tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/switch.html">Switch tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="task_types/ref.html">Reference tasks</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Guides</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../guides/running_guide.html">Running tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/help_guide.html">Documenting tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/args_guide.html">Configuring CLI arguments</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/composition_guide.html">Composing tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/include_guide.html">Loading tasks from another file</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/packaged_tasks.html">Loading tasks from a python package</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/global_tasks.html">Global tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/tox_replacement_guide.html">Replacing tox with uv and Poe the Poet</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/without_poetry.html">Usage without poetry</a></li>
<li class="toctree-l2"><a class="reference internal" href="../guides/library_guide.html">Using poethepoet as a library</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../env_vars.html">Environment variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../license.html">Licence</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="edit-this-page">
  <a class="muted-link" href="https://github.com/nat-n/poethepoet/edit/main/docs/tasks/options.rst" title="Edit this page">
    <svg aria-hidden="true" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <path d="M4 20h4l10.5 -10.5a1.5 1.5 0 0 0 -4 -4l-10.5 10.5v4" />
      <line x1="13.5" y1="6.5" x2="17.5" y2="10.5" />
    </svg>
    <span class="visually-hidden">Edit this page</span>
  </a>
</div><div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="standard-task-options">
<h1>Standard task options<a class="headerlink" href="#standard-task-options" title="Link to this heading">Â¶</a></h1>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Link to this heading">Â¶</a></h2>
<p>The following options can be configured on your tasks and are not specific to any particular task type.</p>
<dl>
<dt><strong>help</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> <a class="reference internal" href="../guides/help_guide.html"><span class="doc">ðŸ“–</span></a></span></dt><dd><p>Help text to be displayed next to the task name in the documentation when poe is run without specifying a task.</p>
</dd>
<dt><strong>args</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict[str,</span> <span class="pre">dict]</span></code> | <code class="docutils literal notranslate"><span class="pre">list[Union[str,</span> <span class="pre">dict]]</span></code> <a class="reference internal" href="../guides/args_guide.html"><span class="doc">ðŸ“–</span></a></span></dt><dd><p>Define CLI options, positional arguments, or flags that this task should accept.</p>
</dd>
<dt><strong>env</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict[str,</span> <span class="pre">str]</span></code> <a class="reference internal" href="#setting-task-specific-environment-variables"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>A map of environment variables to be set for this task.</p>
</dd>
<dt><strong>envfile</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> | <code class="docutils literal notranslate"><span class="pre">list[str]</span></code> <a class="reference internal" href="#loading-environment-variables-from-an-env-file"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Provide one or more env files to be loaded before running this task.</p>
</dd>
<dt><strong>cwd</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> <a class="reference internal" href="#running-a-task-with-a-specific-working-directory"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Specify the current working directory that this task should run with. The given path is resolved relative to the parent directory of the <code class="docutils literal notranslate"><span class="pre">pyproject.toml</span></code>, or it may be absolute.
Resolves environment variables in the format <code class="docutils literal notranslate"><span class="pre">${VAR_NAME}</span></code>.</p>
</dd>
<dt><strong>deps</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">list[str]</span></code> <a class="reference internal" href="../guides/composition_guide.html"><span class="doc">ðŸ“–</span></a></span></dt><dd><p>A list of task invocations that will be executed before this one.</p>
</dd>
<dt><strong>uses</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">dict[str,</span> <span class="pre">str]</span></code> <a class="reference internal" href="../guides/composition_guide.html"><span class="doc">ðŸ“–</span></a></span></dt><dd><p>Allows this task to use the output of other tasks which are executed first.
The value is a map where the values are invocations of the other tasks, and the keys are environment variables by which the results of those tasks will be accessible in this task.</p>
</dd>
<dt><strong>capture_stdout</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> <a class="reference internal" href="#redirect-task-output-to-a-file"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Causes the task output to be redirected to a file with the given path.</p>
</dd>
<dt><strong>executor</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">str</span></code> | <code class="docutils literal notranslate"><span class="pre">dict[str,</span> <span class="pre">str]</span></code> <a class="reference internal" href="#configure-the-executor-for-a-task"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Specify executor type and/or configuration for this task.</p>
</dd>
<dt><strong>verbosity</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">int</span></code> <a class="reference internal" href="#configure-task-level-verbosity"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Specify the verbosity level for this task, from -2 (least verbose) to 2 (most verbose), overriding the project level verbosity setting, which defaults to 0.</p>
</dd>
<dt><strong>use_exec</strong><span class="classifier"><code class="docutils literal notranslate"><span class="pre">bool</span></code> <a class="reference internal" href="#defining-tasks-that-run-via-exec-instead-of-a-subprocess"><span class="std std-ref">ðŸ“–</span></a></span></dt><dd><p>Specify that this task should be executed in the same process, instead of as a subprocess.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This option is only applicable to <strong>cmd</strong>, <strong>script</strong>, and <strong>expr</strong> tasks, and it implies the task in question cannot be referenced by another task.</p>
</div>
</dd>
</dl>
</section>
<section id="setting-task-specific-environment-variables">
<h2>Setting task specific environment variables<a class="headerlink" href="#setting-task-specific-environment-variables" title="Link to this heading">Â¶</a></h2>
<p>You can specify arbitrary environment variables to be set for a single task by providing the env option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;myapp:run&quot;</span>
<span class="n">env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">PORT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;9001&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>Notice this example uses deep keys which can be more convenient but arenâ€™t as well supported by some older toml implementations.</p>
<section id="setting-defaults-for-environment-variables">
<h3>Setting defaults for environment variables<a class="headerlink" href="#setting-defaults-for-environment-variables" title="Link to this heading">Â¶</a></h3>
<p>The previous example can be modified to only set the <cite>PORT</cite> variable if it is not already set by replacing the last line with the following:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">env</span><span class="p">.</span><span class="n">PORT</span><span class="p">.</span><span class="n">default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;9001&quot;</span>
</pre></div>
</div>
</section>
<section id="templating-environment-variables">
<h3>Templating environment variables<a class="headerlink" href="#templating-environment-variables" title="Link to this heading">Â¶</a></h3>
<p>It is also possible to reference existing environment variables when defining a new environment variable for a task. This may be useful for aliasing or extending a variable already defined in the host environment, globally in the config, or in a referenced envfile. In the following example the value from $TF_VAR_service_port on the host environment is also made available as $FLASK_RUN_PORT within the task.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;flask run&quot;</span>
<span class="n">env</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">FLASK_RUN_PORT</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;${TF_VAR_service_port}&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
</section>
<section id="loading-environment-variables-from-an-env-file">
<span id="envfile-option"></span><h3>Loading environment variables from an env file<a class="headerlink" href="#loading-environment-variables-from-an-env-file" title="Link to this heading">Â¶</a></h3>
<p>You can also specify one or more env files (with bash-like syntax) to load per task like so:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># .env</span>
<span class="nv">STAGE</span><span class="o">=</span>dev
<span class="nv">PASSWORD</span><span class="o">=</span><span class="s1">&#39;!@#$%^&amp;*(&#39;</span>
</pre></div>
</div>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks]</span>
<span class="n">serve</span><span class="p">.</span><span class="n">script</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;myapp:run&quot;</span>
<span class="n">serve</span><span class="p">.</span><span class="n">envfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;.env&quot;</span>
</pre></div>
</div>
<p>The envfile option accepts the name (or relative path) to a single envfile as shown above but can also by given a list of such paths like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="n">serve</span><span class="p">.</span><span class="n">envfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;.env&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;local.env&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Normally a missing envfile results in a warning, however optional envfiles can be indicated with the following structure including the <code class="docutils literal notranslate"><span class="pre">optional</span></code> key, in contrast with the <code class="docutils literal notranslate"><span class="pre">expected</span></code> key:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve.envfile]</span>
<span class="n">optional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;local.env&quot;</span><span class="p">]</span>
<span class="n">expected</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;base.env&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Files are loaded in the listed order, optional files are loaded after expected files. Last file wins in case of conflicts.</p>
<p>Normally envfile paths are resolved relative to the project root (that is the parent directory of the pyproject.toml). However when working with a monorepo it can also be useful to specify the path relative to the root of the git repository, which can be done by referencing the <code class="docutils literal notranslate"><span class="pre">POE_GIT_DIR</span></code> or <code class="docutils literal notranslate"><span class="pre">POE_GIT_ROOT</span></code> variables like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe]</span>
<span class="n">envfile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${POE_GIT_DIR}/.env&quot;</span>
</pre></div>
</div>
<p>See the documentation on <a class="reference internal" href="../env_vars.html#special-variables"><span class="std std-ref">Special variables</span></a> for a full explanation of how these variables work.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>For a more detailed explanation see the documentation for <a class="reference internal" href="../global_options.html#loading-external-environment-variables"><span class="std std-ref">the envfile global option</span></a> which works in the same way.</p>
</div>
</section>
</section>
<section id="running-a-task-with-a-specific-working-directory">
<h2>Running a task with a specific working directory<a class="headerlink" href="#running-a-task-with-a-specific-working-directory" title="Link to this heading">Â¶</a></h2>
<p>By default tasks are run from the project root â€“ that is the parent directory of the pyproject.toml file. However if a task needs to be run in another directory then this can be accomplished by using the <code class="code highlight toml docutils literal highlight-toml"><span class="n">cwd</span></code> option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.build-client]</span>
<span class="n">cmd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;npx ts-node -T ./build.ts&quot;</span>
<span class="n">cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;./client&quot;</span>
</pre></div>
</div>
<p>In this example, the npx executable is executed inside the <code class="code highlight sh docutils literal highlight-sh">./client</code> subdirectory of the project (when <code class="docutils literal notranslate"><span class="pre">cwd</span></code> is a relative path, it gets resolved relatively to the project root), and will use the nodejs package.json configuration from that location and evaluate paths relative to that location.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">cwd</span></code> option also accepts absolute paths and resolves environment variables in the format <code class="docutils literal notranslate"><span class="pre">${VAR_NAME}</span></code>.</p>
<p>Poe provides its own <code class="code highlight sh docutils literal highlight-sh"><span class="nv">$POE_PWD</span></code> variable that is by default set to the directory, from which poe was executed; this may be overridden by setting the variable to a different value beforehand. Using <code class="code highlight sh docutils literal highlight-sh"><span class="nv">$POE_PWD</span></code>, a taskâ€™s working directory may be set to the one from which it was executed like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.convert]</span>
<span class="n">script</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;my_project.conversion_tool:main&quot;</span>
<span class="n">cwd</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;${POE_PWD}&quot;</span>
</pre></div>
</div>
</section>
<section id="redirect-task-output-to-a-file">
<h2>Redirect task output to a file<a class="headerlink" href="#redirect-task-output-to-a-file" title="Link to this heading">Â¶</a></h2>
<p>You can configure poe to redirect the standard output of a task to a file on disk by providing the <code class="docutils literal notranslate"><span class="pre">capture_stdout</span></code> option like so.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">cmd</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gunicorn ./my_app:run&quot;</span>
<span class="n">capture_stdout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gunicorn_log.txt&quot;</span>
</pre></div>
</div>
<p>If a relative path is provided, as in the example above, then it will be resolved relative to the project root directory.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">capture_stdout</span></code> option supports referencing environment variables. For example setting <code class="docutils literal notranslate"><span class="pre">capture_stdout</span> <span class="pre">=</span> <span class="pre">&quot;${POE_PWD}/output.txt&quot;</span></code> will cause the output file to be created within the current working directory of the parent process.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The <code class="docutils literal notranslate"><span class="pre">capture_stdout</span></code> is incompatible with the <code class="docutils literal notranslate"><span class="pre">use_exec</span></code> option, and tasks that declare it cannot be referenced by another task via the <code class="docutils literal notranslate"><span class="pre">uses</span></code> option.</p>
</div>
<p>The value <code class="docutils literal notranslate"><span class="pre">/dev/null</span></code> or <code class="docutils literal notranslate"><span class="pre">NUL</span></code> may be used to discard all output from the task.</p>
</section>
<section id="configure-the-executor-for-a-task">
<h2>Configure the executor for a task<a class="headerlink" href="#configure-the-executor-for-a-task" title="Link to this heading">Â¶</a></h2>
<p>You can specify a different executor for a task by providing the <code class="docutils literal notranslate"><span class="pre">executor</span></code> option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gunicorn ./my_app:run&quot;</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;virtualenv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;./server.venv&quot;</span><span class="w"> </span><span class="p">}</span>
</pre></div>
</div>
<p>This works exactly like the the global option to <a class="reference internal" href="../global_options.html#configure-the-executor"><span class="std std-ref">configure the executor</span></a> except it only impacts the one task. If the task does not specify a different executor type, then it will inherit from and extend the global executor configuration (assuming the type is the same).</p>
<p>If you only want to change the executor type but not provide any additional configuration, you can also specify the executor as a simple string like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gunicorn ./my_app:run&quot;</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;poetry&quot;</span>
</pre></div>
</div>
<section id="configure-task-level-virtualenv-with-uv">
<h3>Configure task level virtualenv with uv<a class="headerlink" href="#configure-task-level-virtualenv-with-uv" title="Link to this heading">Â¶</a></h3>
<p>The uv executor supports configuring uv to run a task with its own environment. This is a powerful feature that allows Poe the Poet + uv to be used as a <a class="reference internal" href="../guides/tox_replacement_guide.html#replacing-tox-with-uv-and-poe-the-poet"><span class="std std-ref">lightweight alternative to tools like tox</span></a> for testing against multiple python versions or dependency sets.</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe]</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;uv&quot;</span>

<span class="k">[tool.poe.tasks.test-py311]</span>
<span class="n">help</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;An alias for the test task that runs with python 3.11&quot;</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pytest&quot;</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">isolated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;3.11&quot;</span><span class="p">}</span>

<span class="k">[tool.poe.tasks.test-py312]</span>
<span class="n">help</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;An alias for the test task that runs with python 3.12&quot;</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pytest&quot;</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">isolated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="n">python</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;3.12&quot;</span><span class="p">}</span>

<span class="k">[tool.poe.tasks.test-matrix]</span>
<span class="n">help</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Run tests for all python versions&quot;</span>
<span class="n">sequence</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;test-py311&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;test-py312&quot;</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that it is not necessary to specify <code class="docutils literal notranslate"><span class="pre">type</span> <span class="pre">=</span> <span class="pre">&quot;uv&quot;</span></code> in the executor configuration if the project is already configured to use the uv executor by default.</p>
<p>You can also specify a dependency on the task level without needing to add it as a project dependency, using the <code class="docutils literal notranslate"><span class="pre">with</span></code> option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.test]</span>
<span class="n">help</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;Run the tests&quot;</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;pytest&quot;</span>
<span class="n">executor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="n">type</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="s2">&quot;uv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;pytest&quot;</span><span class="p">],</span><span class="w"> </span><span class="n">isolated</span><span class="w"> </span><span class="p">=</span><span class="w"> </span><span class="kc">true</span><span class="p">}</span>
</pre></div>
</div>
<p>Executor options can also be set at runtime via the <code class="docutils literal notranslate"><span class="pre">--executor-opt</span></code> CLI option (before the task name) to override or add to the executor configuration for a specific task invocation.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>poe<span class="w"> </span>--executor<span class="w"> </span>uv<span class="w"> </span>--executor-opt<span class="w"> </span><span class="nv">with</span><span class="o">=</span>pytest<span class="w"> </span>--executor-opt<span class="w"> </span>isolated<span class="w"> </span>--executor-opt<span class="w"> </span><span class="nv">with</span><span class="o">=</span>pytest-cov<span class="w"> </span>--executor-opt<span class="w"> </span><span class="nv">python</span><span class="o">=</span><span class="m">3</span>.12<span class="w"> </span><span class="nb">test</span><span class="w"> </span>--cov<span class="w"> </span>my_package
</pre></div>
</div>
<p>Multiple values can be provided for options that accept lists by passing the <code class="docutils literal notranslate"><span class="pre">--executor-opt</span></code> option multiple times as shown above.</p>
</section>
</section>
<section id="configure-task-level-verbosity">
<h2>Configure task level verbosity<a class="headerlink" href="#configure-task-level-verbosity" title="Link to this heading">Â¶</a></h2>
<p>You can specify the verbosity level for a task by providing the <code class="code highlight toml docutils literal highlight-toml"><span class="n">verbosity</span></code> option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.credentials]</span>
<span class="n">cmd</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;aws secretsmanager get-secret-value --secret-id creds --query &#39;SecretString&#39;&quot;</span>
<span class="n">verbosity</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">-1</span>
</pre></div>
</div>
<p>This overrides the project level verbosity setting, which defaults to 0. The verbosity level can be set to an integer from -2 (least verbose) to 2 (most verbose).</p>
<p>Passing the <code class="docutils literal notranslate"><span class="pre">-v</span></code> or <code class="docutils literal notranslate"><span class="pre">-q</span></code> global options (before the task name on the command line) will override increment or decrement all verbosity levels.</p>
<section id="verbosity-levels">
<h3>Verbosity levels<a class="headerlink" href="#verbosity-levels" title="Link to this heading">Â¶</a></h3>
<p>The verbosity level is an integer, where positive values increase the verbosity of the output, and negative values decrease it. The levels are as follows:</p>
<ul class="simple">
<li><p>-3 : suppress all output, including errors</p></li>
<li><p>-2 : suppress warning messages</p></li>
<li><p>-1 : suppress info messages such as those describing which tasks are being run</p></li>
<li><p>0 : standard verbosity</p></li>
<li><p>1 : some extra details in output</p></li>
<li><p>2 : more extra details in output</p></li>
<li><p>3 : debug output referencing poethepoet internals (similar to setting <code class="docutils literal notranslate"><span class="pre">POE_DEBUG=1</span></code>)</p></li>
</ul>
<p>Note that the verbosity level only applies to output from poethepoet itself, and does not impact the output of the tasks being run.</p>
<p>Inline tasks (such as those defined within a sequence task) inherit the verbosity level of their parent task, unless they explicitly override it.</p>
<p>The verbosity modifying global cli options may be provided multiple times to increment or decrement the verbosity level by 1 for each occurrence. For example, running <code class="docutils literal notranslate"><span class="pre">poe</span> <span class="pre">-qq</span> <span class="pre">test</span></code> will run the <code class="docutils literal notranslate"><span class="pre">test</span></code> task with a verbosity level of -2 relative to the baseline otherwise specified for the project or task.</p>
</section>
</section>
<section id="defining-tasks-that-run-via-exec-instead-of-a-subprocess">
<h2>Defining tasks that run via exec instead of a subprocess<a class="headerlink" href="#defining-tasks-that-run-via-exec-instead-of-a-subprocess" title="Link to this heading">Â¶</a></h2>
<p>Normally tasks are executed as subprocesses of the <code class="docutils literal notranslate"><span class="pre">poe</span></code> executable. This makes it possible for poe to run multiple tasks, for example within a sequence task or task graph.</p>
<p>However in certain situations it can be desirable to define a task that is instead executed within the same process via an <em>exec</em> call. <a class="reference internal" href="task_types/cmd.html"><span class="doc">cmd tasks</span></a> and <a class="reference internal" href="task_types/script.html"><span class="doc">script tasks</span></a> tasks can be configured to work this way using the <code class="code highlight toml docutils literal highlight-toml"><span class="n">use_exec</span></code> option like so:</p>
<div class="highlight-toml notranslate"><div class="highlight"><pre><span></span><span class="k">[tool.poe.tasks.serve]</span>
<span class="n">cmd</span><span class="w">      </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;gunicorn ./my_app:run&quot;</span>
<span class="n">use_exec</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">true</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note the following limitations with this feature:</p>
<ol class="arabic simple">
<li><p>a task configured in this way may not be referenced by another task</p></li>
<li><p>this does not work on windows because of <a class="reference external" href="https://bugs.python.org/issue19066">this issue</a>. On windows a subprocess is always created.</p></li>
</ol>
</div>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="task_types/cmd.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="docutils literal notranslate"><span class="pre">cmd</span></code> tasks</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Defining tasks</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; Nat Noordanus
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            <div class="icons">
              <a class="muted-link " href="https://pypi.org/project/poethepoet/" aria-label="PyPI">
                <svg version="1.1" xmlns="http://www.w3.org/2000/svg"  stroke="currentColor" fill="currentColor" stroke-width="0" width="16px" height="16" viewBox="0 0 512 512">
                    <path d="M454,305.8294373l-91.1191101,33.691803v106.4807434L181.94487,512V298.2970276l179.8842926-66.8633728V58.8240128L454,92.4968643V305.8294373z M276.8390503,363.3849487c-15.7174377,5.7245483-28.4572144,23.9239502-28.4515686,40.6481018c0.0061646,16.7174377,12.7523499,25.6329346,28.4636841,19.919281c15.7173462-5.7247009,28.4602051-23.9217834,28.4544983-40.6459656C305.303009,366.5810547,292.5565491,357.6635437,276.8390503,363.3849487z M334.6160889,212.4997864l-180.3925323,66.8782959l0.2966461,135.7604065l-64.2104874,22.9912415L0,405.2594604V191.9265442l90.704361-33.6917877V51.7543259L232.9717102,0l101.6443787,32.4636765V212.4997864z M215.2144775,94.8330383c-15.7174835,5.7222672-28.4621582,23.9249802-28.458725,40.6499329c0.0025787,16.725235,12.750824,25.6462555,28.4683228,19.9248505c15.7174988-5.7219086,28.4623871-23.9248047,28.4592285-40.6498184C243.6806641,98.0326996,230.9319763,89.1116333,215.2144775,94.8330383z"/>
                </svg>
            </a>
              <a class="muted-link " href="https://github.com/nat-n/poethepoet" aria-label="GitHub">
                <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 16 16">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0 0 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
              
            </div>
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Standard task options</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#setting-task-specific-environment-variables">Setting task specific environment variables</a><ul>
<li><a class="reference internal" href="#setting-defaults-for-environment-variables">Setting defaults for environment variables</a></li>
<li><a class="reference internal" href="#templating-environment-variables">Templating environment variables</a></li>
<li><a class="reference internal" href="#loading-environment-variables-from-an-env-file">Loading environment variables from an env file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#running-a-task-with-a-specific-working-directory">Running a task with a specific working directory</a></li>
<li><a class="reference internal" href="#redirect-task-output-to-a-file">Redirect task output to a file</a></li>
<li><a class="reference internal" href="#configure-the-executor-for-a-task">Configure the executor for a task</a><ul>
<li><a class="reference internal" href="#configure-task-level-virtualenv-with-uv">Configure task level virtualenv with uv</a></li>
</ul>
</li>
<li><a class="reference internal" href="#configure-task-level-verbosity">Configure task level verbosity</a><ul>
<li><a class="reference internal" href="#verbosity-levels">Verbosity levels</a></li>
</ul>
</li>
<li><a class="reference internal" href="#defining-tasks-that-run-via-exec-instead-of-a-subprocess">Defining tasks that run via exec instead of a subprocess</a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=9c6af99a"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=32e29ea5"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script>
        (function(){
            var plausible_script = document.createElement('script');
            plausible_script.setAttribute('defer','true');
            plausible_script.setAttribute('data-domain','poethepoet.natn.io');
            plausible_script.setAttribute('src','https://plausible.io/js/script.js');
            document.head.appendChild(plausible_script);
        })()
        </script>
    </body>
</html>